---
title: "R Notebook"
output: html_notebook
---



```{r}
library(tidyverse)
library(tidylog)
theme_set(cowplot::theme_cowplot())
```



```{r}
p1 <- cross_df(list(x = seq(0, 104), mu = c(4, 16, 64))) %>%
  mutate(density = dpois(x, lambda = mu)) %>%
  ggplot(aes(x = x, y = density, fill = as.factor(mu)))+
    # geom_histogram(position = "identity", alpha = 0.8, breaks = seq(-1, 101) + 0.5) +
    geom_col(position = "identity", alpha = 0.8) +
    geom_vline(xintercept = c(4, 16, 64)) +
    scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
    scale_x_continuous(breaks = seq(0, 100, by = 25), expand = expansion(add = c(0.5, 0))) +
    guides(fill = "none") +
    labs(x = "Counts", y = "") +
    theme(axis.line.y = element_blank(),
          axis.text.y = element_blank(),
          axis.ticks.y = element_blank(),
          axis.title.y = element_blank(),
          plot.margin = unit(c(5, 3, 5, 3), "pt"))

p1
```



```{r}
sqrt_pos <- 17
acosh_pos <- 16
log_pos <- 15

alpha <- 0.1

p2 <- tibble(x = seq(0, 40, l = 1001)) %>%
  mutate(sqrt = 2 * sqrt(alpha * x),
         log = log(x + 1/(4*alpha)) + log(4 * alpha),
         acosh = acosh(2 * alpha * x + 1)) %>%
  ggplot(aes(x = x)) +
    geom_line(aes(y = sqrt), color = "#016FB9", size = 2) +
    geom_point(data = . %>% filter(x %% 1 == 0), aes(y = sqrt), color = "#016FB9", size = 2) +
    geom_line(aes(y = acosh), color = "#353531", size = 2) +
    geom_point(data = . %>% filter(x %% 1 == 0), aes(y = acosh), color = "#353531", size = 2) +
    geom_line(aes(y = log), color = "#EC4E20", size = 2) +
    geom_point(data = . %>% filter(x %% 1 == 0), aes(y = log), color = "#EC4E20", size = 2) +
    annotate(geom = "text", x = sqrt_pos + 0.2, y = 2 * sqrt(alpha * sqrt_pos), label = expression(s~sqrt(y)),
             hjust = 0, vjust = -0.4, size = 5, angle = 20) +
    annotate(geom = "text", x = acosh_pos, y = acosh(2 * alpha * acosh_pos + 1), label = expression(acosh(2~alpha~y+1)),
             hjust = 0, vjust = -0.2, size = 5, angle = 10) +
    annotate(geom = "text", x = log_pos, y = log(4  * alpha * log_pos + 1), label = expression(log(y+1/(4*alpha))+a),
             hjust = 0, vjust = 1.2, size = 5, angle = 8) +
    # annotate(geom = "text", x = 28, y = 0.15, hjust = 1, vjust = 0, label = "y", size = 4, color = "darkgrey") +  
    # annotate(geom = "text", x = 0.3, y = 3.7, hjust = 0, vjust = 1, label = "g(y)", size = 4, color = "darkgrey") +  
    coord_cartesian(ylim = c(0, 3.4), xlim = c(0, 28), clip = "off") +
    scale_y_continuous(expand = expansion(add = c(0, 0.3))) +
    scale_x_continuous(expand = expansion(0)) +
    # theme(axis.title.x = element_blank(),
    #       axis.title.y = element_blank())
    labs(x = "y", y = "g(y)")

p2
```

```{r comb_plot, fig.width=6.69, fig.height=3}
cowplot::plot_grid(p1, p2, nrow = 1, align = "h", rel_widths = c(1, 1), labels = c("A", "B"))
cowplot::save_plot("../output/heteroskedasticity/heteroskedasticity_and_graph_of_vsts_raw.pdf", last_plot(), base_width = 6.69, base_height = 2, scale = 1.25)
```


# Session Info

```{r}
sessionInfo()
```


